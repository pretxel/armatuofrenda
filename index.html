<html>

<head>
    <title>arma tu ofrenda</title>
    <!--  <link href="http://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/css/base/jquery.ui.all.css" rel="stylesheet"> -->
    <link href="css/jquery-ui-1.10.2.custom.min.css" rel="stylesheet">
    <link href="css/hover.css" rel="stylesheet" media="all">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <script src="js/touch-punch.js"></script>
    <script src="js/Vicky.framework.js"></script>
    <script src="js/html2canvas.js"></script>
    <script src="js/html2canvas.svg.js"></script>
    <script src="js/jquery.plugin.html2canvas.js"></script>
    



    <script>
    $(function() {


        console.log($(window).width());
        console.log($(window).height());

        //
        resize();

        //Load images svgs until 6 elements
        loadImages(Vicky.countItems, Vicky.countItems + 6);

        //Enable elements drag
        dragElement(true);


        $("#btnImagen").on("click", function() {
            $("#fileU").click();
        });

        $("#captura").on("click", function() {
            capturarPantalla();

        });

        $("#fileU").on("change", function(evt) {
            var files = evt.target.files; // FileList object

            // Obtenemos la imagen del campo "file".
            for (var i = 0, f; f = files[i]; i++) {
                //Solo admitimos im√°genes.
                if (!f.type.match('image.*')) {
                    continue;
                }

                var reader = new FileReader();

                reader.onload = (function(theFile) {
                    return function(e) {
                        // Insertamos la imagen
                        document.getElementById("imagenDif").innerHTML = ['<img class="thumb" src="', e.target.result, '" title="', escape(theFile.name), '"/>'].join('');
                    };
                })(f);

                reader.readAsDataURL(f);
            }

        });


        $("#ocultarMenu").on("click", function() {
            $(".decoraciones").animate({
                left: '-100px'
            });
            // $("#mostrarMenu").css("display", "block");
            $("#mostrarMenu").fadeIn("slow");
        });

        $("#mostrarMenu").on("click", function() {
            // $("#mostrarMenu").css("display", "none");
            $("#mostrarMenu").fadeOut("slow");
            $(".decoraciones").animate({
                left: '0px'
            });
        });

        $("#mas").on("click", function() {
            loadImages(Vicky.countItems, Vicky.countItems + 6);

        });

        $(".droppable-ofrenda").droppable({
            activeClass: "ui-state-hover",
            hoverClass: "ui-state-active",
            drop: function(event, ui) {
                console.log("Drop IN");
                if (!ui.helper.hasClass("inOfrenda")) {

                    $(ui.helper[0]).clone().addClass("inOfrenda").appendTo(this.parentElement);
                }

            },
            out: function(event, ui) {
                $(this).removeClass("ui-state-highlight");
                $(this).find("p").html("Selecciona!");
                console.log("Drop OUT");
            }
        });

        $(".droppable-basura").droppable({
            activeClass: "ui-state-hover",
            hoverClass: "ui-state-active",
            drop: function(event, ui) {
                console.log("Drop BASURA");
                // ui.draggable.fadeOut("slow");
                ui.draggable.fadeOut(1500);
                setTimeout(function() {
                    ui.draggable.remove();
                }, 1500);

            },
            out: function(event, ui) {
                $(this).removeClass("ui-state-highlight");
                $(this).find("p").html("Selecciona!");
                console.log("Drop OUT");
            }
        });


        function dragElement(isClone) {

            if (isClone) {

                $(".draggable-ofrenda").draggable({
                    helper: "clone",
                    start: function(event, ui) {

                    },
                    stop: function(event, ui) {
                        newId = 10;
                        //$(this).clone().attr('id', this.id).appendTo(this.parentElement);

                        dragElement(false);
                    }
                });

            } else {

                $(".draggable-ofrenda").draggable({
                    start: function(event, ui) {

                    },
                    stop: function(event, ui) {
                        newId = 10;
                        //$(this).clone().attr('id', this.id).appendTo(this.parentElement);

                        dragElement(false);
                    }
                });

            }


        }


    });




    function loadImages(vinit, vfinal) {

        $("ul.listaDrag li").css("display", "none");

        for (vinit; vinit < vfinal; vinit++) {
            $("#r" + vinit).css("display", "block");
        }

        // $("#ratras").css("display", "block");
        $("#rmas").css("display", "block");
        $("#rmenos").css("display", "block");
        $("#btnGuardar").css("display", "block");
        $("#btnbasura").css("display", "block");

        Vicky.countItems = Vicky.countItems + 6;

        if (Vicky.countItems > 22) {
            Vicky.countItems = 1;
        }

    }

    // function preload() {

    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)] = new Image()
    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)].src = "images/heroes/" + preload.arguments[1] + "" + i + ".png"
    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)].width = "150";
    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)].id = "heroe";


    // }


    function resize() {
        var ancho = $(window).width();
        var alto = $(window).height();

        var centro = ancho / 2;
        var centroAlto = alto / 2;

        var centroX = $(".droppable-ofrenda").width();
        var centroY = $(".droppable-ofrenda").height();

        $("#btnImagen").css("margin-left", (centroX / 2) - 20);
        $("#btnImagen").css("margin-top",  (centroY/2) - 120) ;

        $("#imagenDif").css("margin-left", (centroX / 2) - 40);
        $("#imagenDif").css("margin-top", (centroY/2) - 170);

    }


    function capturarPantalla() {
        html2canvas($("#element"), {
            logging: true,
            onrendered: function(canvas) {
                //document.body.appendChild(canvas);
                var img = canvas.toDataURL()
                window.open(img);
            }
        });
    }
    </script>


</head>

<body>




    <div class="ofrenda">
        <div id="boteBasura" class="ui-widget-header ui-droppable droppable-basura">
            <img src="images/basura.svg" width="100%">
        </div>
        <button id="captura"><img src="images/guardar.svg" style="width: 60px;"></button>

        

        <!-- <article class="ofrenda">

      <div id="drop" class="ui-widget-header ui-droppable droppable-ofrenda">
          <p>Selecciona</p>
          </div>

          <div id="drop" class="ui-widget-header ui-droppable droppable-ofrenda">
            <p>Selecciona</p>
          </div>

          

    </article> -->

        <!-- <img id="mostrarMenu" src="images/arrow-right.svg" style="width: 60px; position: fixed; display:none; cursor: pointer;"> -->



        <!-- <div id="contenOfre" class="container"> -->

            <div id="element">

           
              <img class="ui-widget-header ui-droppable droppable-ofrenda" src="images/ofreda_SIN.jpg">
            
            
              <div id="btnImagen"></div>
            <div id="imagenDif"></div>
            </div>

            


            


        <!-- </div> -->



        <article class="decoraciones">
         
          <img src="images/abajo_escritorio.jpg" style="width: 100%; height: 30%;">

            <ul class="listaDrag">
               <!--  <li id="ratras">
                    <img id="ocultarMenu" class="button pulse-grow" src="images/izq.svg" style="width: 60px;">
                </li> -->
                <li id="rmenos">
                    <img id="rmenos" class="button pulse-grow" src="images/izq.svg" style="width: 60px;">
                </li>
                <li id="r1">
                    <img id="1" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/agua.svg">
                </li>
                <li id="r2">
                    <img id="2" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/botella.svg">
                </li>
                <li id="r3">
                    <img id="3" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/calaverita_azucar.svg">
                </li>
                <li id="r4">
                    <img id="4" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/calaverita_choco.svg">
                </li>
                <li id="r5">
                    <img id="5" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/cana.svg">
                </li>
                <li id="r6">
                    <img id="6" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/cerveza.svg">
                </li>
                <li id="r7">
                    <img id="7" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/copal.svg">
                </li>
                <li id="r8">
                    <img id="8" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/croquetas.svg">
                </li>
                <li id="r9">
                    <img id="9" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/cruz.svg">
                </li>
                <li id="r10">
                    <img id="10" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/flor_anaranjada.svg">
                </li>
                <li id="r11">
                    <img id="11" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/flor_morada.svg">
                </li>
                <li id="r12">
                    <img id="12" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/mandarina.svg">
                </li>
                <li id="r13">
                    <img id="13" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/manzana.svg">
                </li>
                <li id="r14">
                    <img id="14" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/mole.svg">
                </li>
                <li id="r15">
                    <img id="15" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/pan_morado.svg">
                </li>
                <li id="r16">
                    <img id="16" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/pan_muerto.svg">
                </li>
                <li id="r17">
                    <img id="17" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/papel_1.svg">
                </li>
                <li id="r18">
                    <img id="18" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/papel_2.svg">
                </li>
                <li id="r19">
                    <img id="19" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/papel_3.svg">
                </li>
                <li id="r20">
                    <img id="20" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/platanos.svg">
                </li>
                <li id="r21">
                    <img id="21" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/sopa.svg">
                </li>
                <li id="r22">
                    <img id="22" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/veladora_1.svg">
                </li>
                <li id="r23">
                    <img id="23" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/veladora_2.svg">
                </li>

                <li id="rmas">
                    <img id="mas" class="button pulse-grow" src="images/der.svg" style="width: 60px;">
                </li>
            </ul>

           <!--  <ul class="listaDrag">
                <li id="btnGuardar">
                    <img id="btnGuardar" class="button pulse-grow" src="images/guardar.svg" style="width: 60px;">
                </li>
                <li id="btnbasura">
                    <img id="btnbasura" class="button pulse-grow" src="images/basura.svg" style="width: 60px;">
                </li>
              </ul> -->

        </article>

      


        <input id="fileU" type="file" style="display: none;">


        <!-- <button onclick="javascript:window.print()">Imprimir</button> -->

        <!--  <div id="draggable1" class="ui-widget-content ui-draggable" style="position: relative;">
        <p>Arrastra1</p>
      </div> -->

        <!-- <canvas height="300px" width="300px" id="micanvas">
Su navegador no soporta en elemento CANVAS</canvas> -->



    </div>
    <!-- End demo -->
</body>

</html>