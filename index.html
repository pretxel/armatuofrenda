<html>

<head>
    <title>arma tu ofrenda</title>
    <!--  <link href="http://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/css/base/jquery.ui.all.css" rel="stylesheet"> -->
    <link href="css/jquery-ui-1.10.2.custom.min.css" rel="stylesheet">
    <link href="css/hover.css" rel="stylesheet" media="all">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link href="css/video-js.css" rel="stylesheet" type="text/css">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <script src="js/touch-punch.js"></script>
    <script src="js/Vicky.framework.js"></script>
    <script src="js/html2canvas.js"></script>
    <script src="js/html2canvas.svg.js"></script>
    <script src="js/jquery.plugin.html2canvas.js"></script>
    <script src="js/video.js"></script>
    
    <!-- Add fancyBox main JS and CSS files -->
  <script type="text/javascript" src="js/jquery.fancybox.js"></script>
  <link rel="stylesheet" type="text/css" href="css/jquery.fancybox.css" media="screen" />
  <!-- Add Thumbnail helper (this is optional) -->
  <link rel="stylesheet" type="text/css" href="css/jquery.fancybox-thumbs.css" />
  <script type="text/javascript" src="js/jquery.fancybox-thumbs.js"></script>
  <!-- Add Button helper (this is optional) -->
  <link rel="stylesheet" type="text/css" href="css/jquery.fancybox-buttons.css" />
  <script type="text/javascript" src="js/jquery.fancybox-buttons.js"></script>

  <!-- Add Media helper (this is optional) -->
  <script type="text/javascript" src="js/jquery.fancybox-media.js"></script>


    <script>
    $(function() {


        console.log($(window).width());
        console.log($(window).height());

        //
        resize();

        //Load images svgs until 6 elements
        loadImages(Vicky.countItems, Vicky.countItems + 6);

        //Enable elements drag
        dragElement(true);

        $('.fancybox').fancybox();

       var video = $(".fancybox");
       video[0].click();

        $("#btnImagen").on("click", function() {
            $("#fileU").click();
        });

        $("#captura").on("click", function() {
            capturarPantalla();

        });

        $("#fileU").on("change", function(evt) {
            var files = evt.target.files; // FileList object

            // Obtenemos la imagen del campo "file".
            for (var i = 0, f; f = files[i]; i++) {
                //Solo admitimos im√°genes.
                if (!f.type.match('image.*')) {
                    continue;
                }

                var reader = new FileReader();

                reader.onload = (function(theFile) {
                    return function(e) {
                        // Insertamos la imagen
                        document.getElementById("imagenDif").innerHTML = ['<img class="thumb" src="', e.target.result, '" title="', escape(theFile.name), '"/>'].join('');
                    };
                })(f);

                reader.readAsDataURL(f);
            }

        });

        $("#refresh").on("click",function(){

          $("#element img.draggable-ofrenda").remove();
          $("#imagenDif").empty();

        });


        $("#ocultarMenu").on("click", function() {
            $(".decoraciones").animate({
                left: '-100px'
            });
            // $("#mostrarMenu").css("display", "block");
            $("#mostrarMenu").fadeIn("slow");
        });

        $("#mostrarMenu").on("click", function() {
            // $("#mostrarMenu").css("display", "none");
            $("#mostrarMenu").fadeOut("slow");
            $(".decoraciones").animate({
                left: '0px'
            });
        });

        $("#mas").on("click", function() {
            loadImages(Vicky.countItems, Vicky.countItems + 6);
        });

        $("#menos").on("click", function() {
            loadImages(Vicky.countItems, Vicky.countItems - 12);
        });

        $(".droppable-ofrenda").droppable({
            drop: function(event, ui) {
                console.log("Drop IN");
                if (!ui.helper.hasClass("inOfrenda")) {

                    $(ui.helper[0]).clone().addClass("inOfrenda").appendTo(this.parentElement);
                }

            },
            out: function(event, ui) {
                $(this).removeClass("ui-state-highlight");
                $(this).find("p").html("Selecciona!");
                console.log("Drop OUT");
            }
        });

        $(".droppable-basura").droppable({
            activeClass: "animBasura",
            hoverClass: "wobble-vertical",
            drop: function(event, ui) {
                console.log("Drop BASURA");
                // ui.draggable.fadeOut("slow");
                ui.draggable.fadeOut(1500);
                setTimeout(function() {
                    ui.draggable.remove();
                }, 1500);

            },
            out: function(event, ui) {
                $(this).removeClass("ui-state-highlight");
                $(this).find("p").html("Selecciona!");
                console.log("Drop OUT");
            }
        });


        

        function dragElement(isClone) {

            if (isClone) {

                $(".draggable-ofrenda").draggable({
                    helper: "clone",
                    start: function(event, ui) {

                    },
                    stop: function(event, ui) {
                        newId = 10;
                        //$(this).clone().attr('id', this.id).appendTo(this.parentElement);

                        dragElement(false);
                    }
                });

            } else {

                $(".draggable-ofrenda").draggable({
                    start: function(event, ui) {

                    },
                    stop: function(event, ui) {
                        newId = 10;
                        //$(this).clone().attr('id', this.id).appendTo(this.parentElement);

                        dragElement(false);
                    }
                });

            }


        }


    });




    function loadImages(vinit, vfinal) {

        $("ul.listaDrag li").css("display", "none");

        if (vfinal == -5){
          vinit = 30;
          vfinal = 19;
        } 
        if (vfinal == -11){
          vinit = 25;
          vfinal = 13;
        }

        if (vfinal > vinit){
           for (vinit; vinit < vfinal; vinit++) {
            $("#r" + vinit).css("display", "block");
          }
          Vicky.countItems = Vicky.countItems + 6;
        }else{
          for (vfinal; vfinal < (vinit - 6); vfinal++) {
            $("#r" + vfinal).css("display", "block");
          }
          Vicky.countItems = Vicky.countItems - 6;
        }

        // $("#ratras").css("display", "block");
        $("#rmas").css("display", "block");
        $("#rmenos").css("display", "block");
        $("#btnGuardar").css("display", "block");
        $("#btnbasura").css("display", "block");

        

        if (Vicky.countItems > 22) {
          Vicky.countItems = 1;
        }else if (Vicky.countItems < 0){
          Vicky.countItems = 19;
        }

    }

    // function preload() {

    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)] = new Image()
    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)].src = "images/heroes/" + preload.arguments[1] + "" + i + ".png"
    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)].width = "150";
    //     Vicky.imagesHeroes[preload.arguments[0]][(i - 1)].id = "heroe";


    // }


    function resize() {
        var ancho = $(window).width();
        var alto = $(window).height();

        var centro = ancho / 2;
        var centroAlto = alto / 2;

        var centroX = $(".droppable-ofrenda").width();
        var centroY = $(".ofrenda").height();

        $("#btnImagen").css("margin-left", (centroX / 2) - 20);
        $("#btnImagen").css("margin-top",  "-30%") ;

        $("#imagenDif").css("margin-left", (centroX / 2) - 50);
        $("#imagenDif").css("margin-top", "-34%");

    }


    function capturarPantalla() {
        html2canvas($("#element"), {
            logging: true,
            onrendered: function(canvas) {
                //document.body.appendChild(canvas);
                var img = canvas.toDataURL()
                var adown = $("#imagenDow").attr("href", img);
                adown[0].click();
                // $("#imagenDow").href(img);
                // window.open(img);
            }
        });
    }
    </script>


</head>

<body>




    <div class="ofrenda">
        

        
        
    
       

        

        <!-- <article class="ofrenda">

      <div id="drop" class="ui-widget-header ui-droppable droppable-ofrenda">
          <p>Selecciona</p>
          </div>

          <div id="drop" class="ui-widget-header ui-droppable droppable-ofrenda">
            <p>Selecciona</p>
          </div>

          

    </article> -->

        <!-- <img id="mostrarMenu" src="images/arrow-right.svg" style="width: 60px; position: fixed; display:none; cursor: pointer;"> -->



        <!-- <div id="contenOfre" class="container"> -->

            <div id="element">

           
              <img id="ofrendaPrincipal" class="ui-widget-header ui-droppable droppable-ofrenda" src="images/ofreda_SIN.jpg">
            
            
              <div id="btnImagen"></div>
            <div id="imagenDif"></div>
            </div>

            


            


        <!-- </div> -->



        <article class="decoraciones">
         
          <img src="images/abajo_escritorio.jpg" style="width: 100%; height: 30%;">

            <ul class="listaDrag">
               <!--  <li id="ratras">
                    <img id="ocultarMenu" class="button pulse-grow" src="images/izq.svg" style="width: 60px;">
                </li> -->
                <li id="rmenos">
                    <img id="menos" class="button pulse-grow" src="images/izq.svg" style="width: 45px;">
                </li>
                <li id="r1">
                    <img id="1" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/agua.svg">
                </li>
                <li id="r2">
                    <img id="2" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/botella.svg">
                </li>
                <li id="r3">
                    <img id="3" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/calaverita_azucar.svg">
                </li>
                <li id="r4">
                    <img id="4" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/calaverita_choco.svg">
                </li>
                <li id="r5">
                    <img id="5" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/cana.svg">
                </li>
                <li id="r6">
                    <img id="6" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/cerveza.svg">
                </li>
                <li id="r7">
                    <img id="7" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/copal.svg">
                </li>
                <li id="r8">
                    <img id="8" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/croquetas.svg">
                </li>
                <li id="r9">
                    <img id="9" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/cruz.svg">
                </li>
                <li id="r10">
                    <img id="10" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/flor_anaranjada.svg">
                </li>
                <li id="r11">
                    <img id="11" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/flor_morada.svg">
                </li>
                <li id="r12">
                    <img id="12" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/mandarina.svg">
                </li>
                <li id="r13">
                    <img id="13" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/manzana.svg">
                </li>
                <li id="r14">
                    <img id="14" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/mole.svg">
                </li>
                <li id="r15">
                    <img id="15" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/pan_morado.svg">
                </li>
                <li id="r16">
                    <img id="16" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/pan_muerto.svg">
                </li>
                <li id="r17">
                    <img id="17" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/papel_1.svg">
                </li>
                <li id="r18">
                    <img id="18" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/papel_2.svg">
                </li>
                <li id="r19">
                    <img id="19" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/papel_3.svg">
                </li>
                <li id="r20">
                    <img id="20" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/platanos.svg">
                </li>
                <li id="r21">
                    <img id="21" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/sopa.svg">
                </li>
                <li id="r22">
                    <img id="22" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/veladora_1.svg">
                </li>
                <li id="r23">
                    <img id="23" class="ui-widget-content ui-draggable draggable-ofrenda button pulse-grow" src="images/svgs/veladora_2.svg">
                </li>

                <li id="rmas">
                    <img id="mas" class="button pulse-grow" src="images/der.svg" style="width: 45px;">
                </li>
            </ul>

           <!--  <ul class="listaDrag">
                <li id="btnGuardar">
                    <img id="btnGuardar" class="button pulse-grow" src="images/guardar.svg" style="width: 60px;">
                </li>
                <li id="btnbasura">
                    <img id="btnbasura" class="button pulse-grow" src="images/basura.svg" style="width: 60px;">
                </li>
              </ul> -->

        </article>

      
        <ul class="listaControl">
          <li>
              <img id="refresh" class="wobble-vertical" src="images/refresh.svg" style="width: 60px;"/>
          </li>

          <li>
              <a id="imagenDow" href="" download style="display: none;">Descargar</a>
              <img id="captura" class="wobble-vertical" src="images/guardar.svg" style="width: 60px;"/>
          </li>  

          <li id="boteBasura" class="ui-widget-header ui-droppable droppable-basura">
          </li>
         
        </ul>

        <input id="fileU" type="file" style="display: none;">

     
  <ul style="display:none;">
    <li><a class="fancybox" href="#inline1" title="" >Inline</a></li>
  </ul>


  <div id="inline1" style="width:640px;display: none;">
    
      <video id="example_video_1" class="video-js vjs-default-skin" controls preload="none" width="640" height="264"
      poster="http://video-js.zencoder.com/oceans-clip.png"
      data-setup="{}">
    <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4' />
    <!-- <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm' /> -->
    <!-- <source src="http://video-js.zencoder.com/oceans-clip.ogv" type='video/ogg' /> -->
  
    <!-- <p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p> -->
  </video>
  
  </div>




    </div>
    <!-- End -->
</body>

</html>